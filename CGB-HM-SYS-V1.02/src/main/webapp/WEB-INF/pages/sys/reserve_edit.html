<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- Tell the browser to be responsive to screen width -->
<meta
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
	name="viewport">
<!-- Bootstrap 3.3.7 -->
<link rel="stylesheet"
	href="bower_components/bootstrap/dist/css/bootstrap.min.css">
<!-- Font Awesome -->
<link rel="stylesheet"
	href="bower_components/font-awesome/css/font-awesome.min.css">
<!-- Ionicons -->
<link rel="stylesheet"
	href="bower_components/Ionicons/css/ionicons.min.css">
<!-- daterange picker -->
<link rel="stylesheet"
	href="bower_components/bootstrap-daterangepicker/daterangepicker.css">
<!-- bootstrap datepicker -->
<link rel="stylesheet"
	href="bower_components/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css">
<!-- iCheck for checkboxes and radio inputs -->
<link rel="stylesheet" href="plugins/iCheck/all.css">
<!-- Bootstrap Color Picker -->
<link rel="stylesheet"
	href="bower_components/bootstrap-colorpicker/dist/css/bootstrap-colorpicker.min.css">
<!-- Bootstrap time Picker -->
<link rel="stylesheet"
	href="plugins/timepicker/bootstrap-timepicker.min.css">
<!-- Select2 -->
<link rel="stylesheet"
	href="bower_components/select2/dist/css/select2.min.css">
<!-- Theme style -->
<link rel="stylesheet" href="dist/css/AdminLTE.min.css">
<!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
<link rel="stylesheet" href="dist/css/skins/_all-skins.min.css">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

<!-- Google Font -->
</head>

<div class="row">
	<div class="col-lg-3 col-xs-6">
		<!-- small box -->
		<div class="small-box bg-aqua">
			<div class="inner">
				<h3>10</h3>

				<p>总房数</p>
			</div>
			<div class="icon">
				<i class="glyphicon glyphicon-th"></i>
			</div>
			<a href="#" class="small-box-footer">More info <i
				class="fa fa-arrow-circle-right"></i></a>
		</div>
	</div>
	<!-- ./col -->
	<div class="col-lg-3 col-xs-6">
		<!-- small box -->
		<div class="small-box bg-green">
			<div class="inner">
				<h3>5</h3>

				<p>单人间</p>
			</div>
			<div class="icon">
				<i class="glyphicon glyphicon-user"></i>
			</div>
			<a href="#" class="small-box-footer">More info <i
				class="fa fa-arrow-circle-right"></i></a>
		</div>
	</div>
	<!-- ./col -->
	<div class="col-lg-3 col-xs-6">
		<!-- small box -->
		<div class="small-box bg-yellow">
			<div class="inner">
				<h3>3</h3>

				<p>双人间</p>
			</div>
			<div class="icon">
				<i class="glyphicon glyphicon-heart"></i>
			</div>
			<a href="#" class="small-box-footer">More info <i
				class="fa fa-arrow-circle-right"></i></a>
		</div>
	</div>
	<!-- ./col -->
	<div class="col-lg-3 col-xs-6">
		<!-- small box -->
		<div class="small-box bg-red">
			<div class="inner">
				<h3>2</h3>

				<p>Vip房</p>
			</div>
			<div class="icon">
				<i class="glyphicon glyphicon-home"></i>
			</div>
			<a href="#" class="small-box-footer">More info <i
				class="fa fa-arrow-circle-right"></i></a>
		</div>
	</div>
	<!-- ./col -->
</div>

<section class="content">
	<!-- Horizontal Form -->
	<div class="box box-info">
		<div class="box-header with-border">
			<h3 class="box-title">客房预订</h3>
		</div>
		<!-- /.box-header -->
		<!-- form start -->
		<form class="form-horizontal">
			<div class="box-body">
				<div class="form-group">
					<label for="reservePeopleId" class="col-sm-2 control-label">姓名</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" name="reservePeople"
							id="reservePeopleId" placeholder="姓名">
					</div>
				</div>


				<!-- 
			<div class="form-group">
				<label for="cardId" class="col-sm-2 control-label">身份证号码</label>
				<div class="col-sm-10">
					<input type="text" class="form-control" name="phone"
						data-inputmask="'mask': ['999999-9999-9999-9999']" data-mask>
				</div>
			</div>
 -->
				<div class="form-group">
					<label for="phoneId" class="col-sm-2 control-label">手机号码</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" name="phone"
							data-inputmask="'mask': ['999-9999-9999']" data-mask
							placeholder="手机号码" id="phoneId">
						<!--            
              <input type="text" class="form-control" name="phone" id="phoneId">
               -->
					</div>
				</div>

				<div class="form-group date">
					<label for="checkoutId" class="col-sm-2 control-label">入住与退房时间</label>

					<div class="col-sm-10">
						<input type="text" class="form-control pull-right" name="checkout"
							id="reservation">
					</div>
				</div>

				<div class="form-group">
					<label for="typeId" class="col-sm-2 control-label">房型</label>


					<div class="col-sm-10">

						<div class="btn-group">
							<button type="button" class="btn btn-default dropdown-toggle"
								data-toggle="dropdown">
								<span class="buttonText">默认</span> <span class="caret"></span>
							</button>
							<ul class="dropdown-menu" role="menu">
								<li><a onclick="shows($(this).text())">单人房</a></li>
								<li><a onclick="shows($(this).text())">双人房</a></li>
								<li><a onclick="shows($(this).text())">VIP</a></li>

							</ul>
						</div>
						<div style="display: inline">剩余数量:</div>
						<div style="display: inline" id="roomNumsId">0</div>
					</div>
				</div>

				<div class="form-group">
					<label for="amountId" class="col-sm-2 control-label">数量</label>
					<!-- 
				<div class="row">
					<div class="col-lg-6">
						<div class="input-group">
							<span class="input-group-btn">
								<button class="btn btn-default" type="button">-</button>
							</span> <input type="text" class="form-control" placeholder="数量">
							<span class="input-group-btn">
								<button class="btn btn-default" type="button">+</button>
							</span>
						</div>
					</div>
				</div>
				 -->

					<div class="col-sm-10">
						<input type="number" class="form-control" name="amount"
							id="amountId" placeholder="数量" min="0">
					</div>

				</div>
				<!-- 
			<div class="form-group date">
				<label for="checkinId" class="col-sm-2 control-label">入住时间</label>
				<div class="col-sm-10">

					<input type="text" class="form-control pull-right" name="checkin"
						id="datepicker">

				</div>
			</div>

 -->


				<!-- 
			<div class="input-group date">
				<div class="input-group-addon">
					<i class="fa fa-calendar"></i>
				</div>
				<input type="text" class="form-control pull-right" id="datepicker">
			</div>

			<div class="input-group">
				<div class="input-group-addon">
					<i class="fa fa-calendar"></i>
				</div>
				<input type="text" class="form-control pull-right" id="reservation">
			</div>
			 -->
				<!-- /.input group -->


			</div>
			<!-- /.box-body -->
			<div class="box-footer">
				<button type="button" class="btn btn-default btn-cancel">Cancel</button>
				<button type="button" class="btn btn-info pull-right btn-save">Save</button>
			</div>
			<!-- /.box-footer -->
		</form>

	</div>
</section>
<!-- bootstrap datepicker -->
<!-- 
<script src="bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
 -->
<!-- date-range-picker -->
<script src="bower_components/moment/min/moment.min.js"></script>
<script
	src="bower_components/bootstrap-daterangepicker/daterangepicker.js"></script>
<!-- bootstrap datepicker -->
<script
	src="bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
<!-- InputMask -->
<script src="plugins/input-mask/jquery.inputmask.js"></script>
<script src="plugins/input-mask/jquery.inputmask.date.extensions.js"></script>
<script src="plugins/input-mask/jquery.inputmask.extensions.js"></script>

<script type="text/javascript">
	$(function() {

		$('[data-mask]').inputmask();
		//Date range picker
		$('#reservation').daterangepicker(
				{},
				function(start, end, label) {
					console.log('New date range selected: '
							+ start.format('YYYY-MM-DD') + ' to '
							+ end.format('YYYY-MM-DD') + ' (predefined range: '
							+ label + ')');
					var intime = new Date(start.format('YYYY-MM-DD'));
					var outtime = new Date(end.format('YYYY-MM-DD'));
					intime.setHours(12);
					outtime.setHours(12);
					$("#mainContentId").data("intime", intime);
					$("#mainContentId").data("outtime", outtime);
					$("#mainContentId")
							.data(
									"liveday",
									Math.floor((outtime - intime)
											/ (24 * 3600 * 1000)));

					console.log(Math.floor((outtime - intime)
							/ (24 * 3600 * 1000)));
					console.log($("#mainContentId").data("intime"));
					doGetReservableRoom();

				});

		//Date picker
		/* 	$('#datepicker').datepicker({
				autoclose : true
			}) */
		$(".box-footer").on("click", ".btn-cancel", doCancel).on("click",
				".btn-save", doSave);

		//新建登记跳转过来的
		if ($("#mainContentId").data("newRegister")) {
			$(".btn-save").html("next");
			console.log("新建登记")
		}
	})
	function shows(a) {
		$('.buttonText').text(a)
		doGetReservableRoom();
	}

	function doGetReservableRoom() {
		var url = "reserve/doGetReservableRoom.do";
		var params = {
			intime : $("#mainContentId").data("intime"),
			outtime : $("#mainContentId").data("outtime"),
			roomtype : $('.buttonText').text()
		}
		console.log(params);
		$.post(url, params, function(result) {
			console.log(result);
			if (result.state == 1) {
				//	 alert(result.message);
				//	 console.log(result.data.length)
				$("#roomNumsId").html(result.data.length);

			} else {
				//	alert(result.message);
				$("#roomNumsId").html(0);
			}

		});
	}

	function doSave() {

		var params = {
			reservepeople : $("#reservePeopleId").val(),
			reservephone : $("#phoneId").val(),
			intime : $("#mainContentId").data("intime"),
			outtime : $("#mainContentId").data("outtime"),
			liveday : $("#mainContentId").data("liveday"),
			roomtype : $('.buttonText').text(),
			roomAmount : $("#amountId").val()
		}
		console.log(params);

		var url = "reserve/doSaveObject.do"
		$.post(url, params, function(result) {
			if (result.state == 1) {
				$("#mainContentId").data("id", result.data);
				//  console.log("id:", $("#mainContentId").data("id"));
				alert(result.message);
				if ($("#mainContentId").data("newRegister")) {

					//跳转到登记页面
					$("#mainContentId").load("register/doRegisterEditUI.do",
							function() {
								$("#mainContentId").data("newRegister", true);
							});
				}

				doCancel();
			} else {
				alert(result.message);
			}
		})

	}
	function doCancel() {
		$("#mainContentId").removeData("intime");
		$("#mainContentId").removeData("outtime");
		$("#mainContentId").removeData("newRegister");
		$("#mainContentId").load("reserve/doReserveListUI.do");
	}
</script>






